{"version":3,"file":"ticket-form.component.js","sourceRoot":"","sources":["file:///C:/Users/funny/Documents/GitHub/dashboard/tmp/broccoli_type_script_compiler-input_base_path-SMUEtNaR.tmp/0/src/app/ticket/ticket-form/ticket-form.component.ts"],"names":[],"mappings":";;;;;;;;;;AAAA,qBAAkC,eAAe,CAAC,CAAA;AAClD,uBAAuB,iBAAiB,CAAC,CAAA;AACzC,+BAA8B,6BAA6B,CAAC,CAAA;AAC5D,6BAA8E,cAAc,CAAC,CAAA;AAU7F;IAcE,6BAAoB,aAA4B,EAAS,EAAe,EAAU,MAAc;QAdlG,iBAkGC;QApFqB,kBAAa,GAAb,aAAa,CAAe;QAAS,OAAE,GAAF,EAAE,CAAa;QAAU,WAAM,GAAN,MAAM,CAAQ;QAZhG,SAAI,GAAG;YACL,KAAK,EAAE,EAAE;YACT,IAAI,EAAE,EAAE;YACR,QAAQ,EAAE,EAAE;YACZ,KAAK,EAAE,EAAE;YACT,QAAQ,EAAE,EAAE;YACZ,WAAW,EAAE,EAAE;SAChB,CAAC;QACF,cAAS,GAAG,KAAK,CAAC;QAClB,kBAAa,GAAG,CAAC,CAAC;QAClB,UAAK,GAAG,EAAE,CAAC;QAGT,EAAE,CAAC,QAAQ,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,SAAS,CAAC,UAAA,MAAM;YACjD,aAAa,CAAC,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC;YAC5C,KAAI,CAAC,aAAa,GAAG,MAAM,CAAC,MAAM,CAAC;QACrC,CAAC,CAAC,CAAC;IACL,CAAC;IAED,sCAAQ,GAAR;QACE,MAAM,CAAC,cAAc,CAAC;aACjB,cAAc,CAAC;YACd,QAAQ,EAAE,OAAO;SAClB,CAAC,CAAC;QACP,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAC;IACzB,CAAC;IAED,uCAAS,GAAT;QACE,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACxB,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,EAAE,CAAC;QACpB,CAAC;QACD,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;IAClB,CAAC;IAED,sCAAQ,GAAR,UAAS,KAAK;QAAd,iBAkBC;QAjBC,IAAI,CAAC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;QACvB,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvB,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,IAAE,CAAC,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,EAAE,CAAC,QAAQ,CAAC,MAAM,CAAC,iBAAiB,GAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,CAAC;gBACnE,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;gBAC5B,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,WAAW;gBAClC,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK;gBACtB,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,QAAQ;gBAC5B,EAAE,EAAE,IAAI,CAAC,aAAa,GAAC,CAAC;gBACxB,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,KAAK;gBACtB,UAAU,EAAE,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,EAAE,GAAC,IAAI;gBACnD,QAAQ,EAAE,QAAQ;aACnB,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;YACtB,UAAU,CAAC,cAAK,OAAA,KAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,cAAc,CAAC,CAAC,EAAtC,CAAsC,EAAE,IAAI,CAAC,CAAC;QAChE,CAAC;IACH,CAAC;IAED,2CAAa,GAAb;QACE,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;QAChB,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACxB,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,IAAE,EAAE,CAAC,CAAC,CAAC;gBACrB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;gBAC1C,MAAM,CAAC;YACT,CAAC;QACH,CAAC;QACD,IAAI,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;QACpF,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,IAAE,CAAC,CAAC,CAAC,CAAC;YAClB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,kCAAkC,CAAC,CAAC;YACpD,MAAM,CAAC;QACT,CAAC;QACD,IAAI,IAAI,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QAClB,IAAI,OAAO,GAAG,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,GAAC,EAAE,CAAC;QAC1C,EAAE,CAAC,CAAC,IAAI,GAAC,MAAM,IAAI,IAAI,GAAC,OAAO,CAAC,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;YAC7C,MAAM,CAAC;QACT,CAAC;QACD,IAAI,KAAK,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QACnB,EAAE,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,IAAE,GAAG,CAAC,CAAC,CAAC;YACzB,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC1B,CAAC;QACD,EAAE,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,GAAC,CAAC,IAAI,MAAM,CAAC,KAAK,CAAC,GAAC,EAAE,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;YAC7C,MAAM,CAAC;QACT,CAAC;QACD,IAAI,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,CAAC;QACjB,EAAE,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,GAAC,CAAC,IAAE,CAAC,CAAC,CAAC,CAAC;YACtB,IAAI,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;QACjB,CAAC;QACD,EAAE,CAAC,CAAC,GAAG,GAAC,IAAI,IAAI,GAAG,GAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;QAC/C,CAAC;QACD,IAAI,EAAE,GAAG,0CAA0C,CAAC;QACpD,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC9B,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC;YACtD,MAAM,CAAC;QACT,CAAC;IACH,CAAC;IAvGH;QAAC,gBAAS,CAAC;YACT,QAAQ,EAAE,MAAM,CAAC,EAAE;YACnB,QAAQ,EAAE,iBAAiB;YAC3B,WAAW,EAAE,4BAA4B;YACzC,SAAS,EAAE,CAAC,2BAA2B,CAAC;SACzC,CAAC;;2BAAA;IAoGF,0BAAC;AAAD,CAAC,AAlGD,IAkGC;AAlGY,2BAAmB,sBAkG/B,CAAA","sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { GlobalService } from '../../shared/global.service';\r\nimport { AngularFire, FirebaseListObservable, FirebaseObjectObservable } from 'angularfire2';\r\ndeclare var jQuery: any;\r\n\r\n@Component({\r\n  moduleId: module.id,\r\n  selector: 'app-ticket-form',\r\n  templateUrl: 'ticket-form.component.html',\r\n  styleUrls: ['ticket-form.component.css'],\r\n})\r\n\r\nexport class TicketFormComponent implements OnInit  {\r\n\r\n  form = {\r\n    title: '',\r\n    date: '',\r\n    customer: '',\r\n    email: '',\r\n    employee: '',\r\n    description: ''\r\n  };\r\n  submitted = false;\r\n  ticket_length = 0;\r\n  error = [];\r\n\r\n  constructor(private globalService: GlobalService, public af: AngularFire, private router: Router) {\r\n    af.database.list('/shared/ticket').subscribe(ticket => {\r\n      globalService.ticket_number = ticket.length;\r\n      this.ticket_length = ticket.length;\r\n    });\r\n  }\r\n\r\n  ngOnInit() {\r\n    jQuery('#datePicker1')\r\n        .datetimepicker({\r\n          language: 'pt-BR'\r\n        });\r\n    console.log('inited!');\r\n  }\r\n\r\n  clearForm() {\r\n    for (var i in this.form) {\r\n      this.form[i] = '';\r\n    }\r\n    this.error = [];\r\n  }\r\n\r\n  onSubmit(value) {\r\n    this.form.date = value;\r\n    console.log(this.form);\r\n    this.onSubmitValid();\r\n    if (this.error.length==0) {\r\n      this.af.database.object('/shared/ticket/'+this.ticket_length).update({\r\n        customer: this.form.customer,\r\n        description: this.form.description,\r\n        email: this.form.email,\r\n        employee: this.form.employee,\r\n        id: this.ticket_length+1,\r\n        title: this.form.title,\r\n        start_date: new Date(this.form.date).getTime()/1000,\r\n        end_date: 'active'\r\n      });\r\n      this.submitted = true;\r\n      setTimeout(()=> this.router.navigate(['/page/ticket']), 3000);\r\n    }\r\n  }\r\n\r\n  onSubmitValid() {\r\n    this.error = [];\r\n    for (var i in this.form) {\r\n      if (this.form[i]=='') {\r\n        this.error.push('Please finish the form');\r\n        return;\r\n      }\r\n    }\r\n    var tmp = this.form.date.split('/');\r\n    var days = ['31', '28', '31', '30', '31', '30', '31', '31', '30', '31', '30', '31'];\r\n    if (tmp.length!=3) {\r\n      this.error.push('Date format should be mm/dd/yyyy');\r\n      return;\r\n    }\r\n    var year = tmp[2];\r\n    var nowyear = new Date().getFullYear()+'';\r\n    if (year<'2010' || year>nowyear) {\r\n      this.error.push('Please enter a valid date');\r\n      return;\r\n    }\r\n    var month = tmp[0];\r\n    if (month.charAt(0)=='0') {\r\n      month = month.charAt(1);\r\n    }\r\n    if (Number(month)<1 || Number(month)>12) {\r\n      this.error.push('Please enter a valid date');\r\n      return;\r\n    }\r\n    var day = tmp[1];\r\n    if (Number(year)%4==0) {\r\n      days[1] = '29';\r\n    }\r\n    if (day<'01' || day>days[Number(month)]) {\r\n      this.error.push('Please enter a valid date');\r\n    }\r\n    var re = /[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm;\r\n    if (!re.test(this.form.email)) {\r\n      this.error.push('Please enter a valid email address');\r\n      return;\r\n    }\r\n  }\r\n\r\n}\r\n"]}